<?php
//=======================================================
// 설  명 : 대량 메일 수신 체크(check.php)
// 책임자 : 박선민 (sponsor@new21.com), 검수: 04/03/19
// Project: sitePHPbasic
// ChangeLog
//	DATE	수정인			 수정 내용
// -------- ------ --------------------------------------
// 04/03/19 박선민 마지막 수정
//=======================================================
$HEADER=array(
	'usedb2'	=>	1, // DB 커넥션 사용 (0:미사용, 1:사용)
);
require("{$_SERVER['DOCUMENT_ROOT']}/sinc/header.php");
//page_security("", $HTTP_HOST);

//=======================================================
// Ready... (변수 초기화 및 넘어온값 필터링)
//=======================================================
	// PHP 7에서 배열 키는 따옴표로 감싸야 함
	if(!$_GET['db']) exit;
	
	// 배열 키는 따옴표로 감싸고, 변수 사용을 명확하게 처리
	$table	= $SITE['th'] . "dmail_" . $_GET['db'];
	
	// 쿼리 내에서 사용할 변수를 미리 정의 (인터폴레이션 시 배열 키 없이 사용 위함)
	$uid	= $_GET['uid'];
	$email	= $_GET['email'];

//=======================================================
// Start... (DB 작업 및 display)
//=======================================================
	// mysql_query()를 사용자 정의 함수 db_query()로 대체
	// 쌍따옴표 내 변수에 괄호 {} 적용 (가독성 및 PHP 7 인터폴레이션 권장 사항 준수)
	@db_query("UPDATE {$table} SET status='READ', readtime=UNIX_TIMESTAMP() WHERE uid='{$uid}' and email='{$email}'");
?>